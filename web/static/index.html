<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#1a1a2e">
  <title>Claude Code Mobile</title>
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="toast-container" id="toast-container"></div>

  <!-- Login Screen -->
  <div class="login-screen" id="login-screen">
    <h1>Claude Code Mobile</h1>
    <p>Enter your access token</p>
    <form id="login-form">
      <input type="password" id="token-input" placeholder="Bearer token" autocomplete="off" required>
      <button type="submit" class="btn btn-primary">Connect</button>
    </form>
  </div>

  <!-- Sessions Screen -->
  <div class="app" id="sessions-screen" style="display:none">
    <div class="header">
      <h1>Sessions</h1>
      <button class="btn btn-primary btn-sm" id="new-session-btn">+ New</button>
      <button class="btn btn-ghost btn-sm" id="logout-btn">Logout</button>
    </div>

    <div class="sessions-view">
      <div class="sessions-toolbar">
        <input type="search" id="search-input" placeholder="Search sessions...">
      </div>

      <div class="filter-chips">
        <span class="chip active" data-filter="all">All</span>
        <span class="chip" data-filter="running">Running</span>
        <span class="chip" data-filter="exited">Exited</span>
      </div>

      <div id="sessions-list"></div>
    </div>
  </div>

  <!-- Session View (Terminal) -->
  <div class="session-view" id="session-screen" style="display:none">
    <div class="header">
      <button class="back-btn" id="back-btn" style="display:none">&larr;</button>
      <h1 id="session-name">Session</h1>
      <span class="status-badge status-running" id="session-status">running</span>
      <button class="btn btn-danger btn-sm" id="header-interrupt">Ctrl+C</button>
    </div>

    <div class="terminal-container" id="terminal-container">
      <div class="terminal-placeholder">
        <p>Select a session to view terminal</p>
      </div>
    </div>

    <!-- Keys Bar -->
    <div class="keys-bar">
      <button class="key-btn" data-key="ESC">Esc</button>
      <button class="key-btn" data-key="TAB">Tab</button>
      <button class="key-btn" data-key="UP">&uarr;</button>
      <button class="key-btn" data-key="DOWN">&darr;</button>
      <button class="key-btn" data-key="LEFT">&larr;</button>
      <button class="key-btn" data-key="RIGHT">&rarr;</button>
      <button class="key-btn" data-key="CTRL_C">^C</button>
      <button class="key-btn" data-key="CTRL_D">^D</button>
      <button class="key-btn" data-key="ENTER">&crarr;</button>
      <button class="key-btn intervene-btn" id="intervene-open">Intervene</button>
    </div>
  </div>

  <!-- Intervene Bottom Sheet -->
  <div class="overlay" id="intervene-overlay"></div>
  <div class="bottom-sheet" id="intervene-sheet">
    <div class="bottom-sheet-handle"></div>
    <div class="bottom-sheet-title">
      <h3>Intervene</h3>
      <button class="btn btn-ghost btn-sm" id="intervene-close">Close</button>
    </div>

    <textarea id="intervene-text" placeholder="Type your instruction to Claude..."></textarea>

    <div class="send-actions">
      <button class="btn btn-primary" id="intervene-send">Send</button>
      <button class="btn btn-ghost btn-sm" id="intervene-send-no-refactor">Send + "no refactor"</button>
      <button class="btn btn-ghost btn-sm" id="intervene-send-summarize">Send + "summarize"</button>
    </div>

    <div class="macros-label">Quick macros</div>
    <div class="macros">
      <span class="macro-chip" data-text="Stop">Stop</span>
      <span class="macro-chip" data-text="Run tests">Run tests</span>
      <span class="macro-chip" data-text="Explain last change">Explain last change</span>
      <span class="macro-chip" data-text="Don't change public API">Keep public API</span>
      <span class="macro-chip" data-text="y">Yes (y)</span>
      <span class="macro-chip" data-text="n">No (n)</span>
      <span class="macro-chip" data-text="git status">git status</span>
      <span class="macro-chip" data-text="git diff --stat">git diff --stat</span>
    </div>
  </div>

  <!-- Create Session Modal -->
  <div class="modal-overlay" id="create-modal">
    <div class="modal">
      <h2>New Session</h2>
      <div class="form-group">
        <label for="create-name">Session Name</label>
        <input type="text" id="create-name" placeholder="my-project" maxlength="30">
      </div>
      <div class="form-group">
        <label for="create-cwd">Working Directory</label>
        <input type="text" id="create-cwd" placeholder="/Users/me/src/project">
      </div>
      <div class="form-group">
        <label for="create-cmd">Start Command</label>
        <input type="text" id="create-cmd" value="claude" placeholder="claude">
      </div>
      <div class="form-error" id="create-error"></div>
      <div class="modal-actions">
        <button class="btn btn-ghost" id="create-cancel">Cancel</button>
        <button class="btn btn-primary" id="create-submit">Create</button>
      </div>
    </div>
  </div>

  <script src="/js/app.js"></script>
  <script>if ('serviceWorker' in navigator) navigator.serviceWorker.register('/sw.js');</script>
</body>
</html>
